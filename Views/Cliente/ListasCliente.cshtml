@model IEnumerable<PROYECTOMOVIE.Models.ListaCliente>

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mis Listas - WatchLenn</title>

    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">
    <link rel="stylesheet" href="~/css/index.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/PROYECTOMOVIE.styles.css" asp-append-version="true" />

    <style>
        html, body { height: 100%; }
        body { display: flex; flex-direction: column; min-height: 100vh; background: var(--bg-dark); color: var(--light); }
        main { flex: 1; padding-top: 70px; }

        /* header (coincide con tus otras vistas) */
        .header{ position:fixed; top:0; left:0; right:0; z-index:1000; backdrop-filter: blur(6px);
                 background: linear-gradient(180deg, rgba(2,2,2,0.12), rgba(10,12,14,0.05)); display:flex;
                 align-items:center; justify-content:space-between; padding:14px 28px; border-bottom:1px solid rgba(255,255,255,0.02);}
        .logo{display:flex;align-items:center;gap:10px;font-weight:700;font-size:20px;color:var(--accent);} 
        .logo i{ color: var(--accent-2); }
        .nav-links{display:flex;gap:14px;align-items:left}
        .nav-links a{color:var(--muted);text-decoration:none;font-size:15px}
        .nav-links a.nav-active, .nav-links a:hover{color:var(--light);transform:translateY(-1px);font-weight:600}

        /* listas */
        .listas-container { padding: 28px 20px; max-width: 1200px; margin: 0 auto; }
        .btn-nueva-lista { background-color: #6f42c1; color: #fff; border-radius: 25px; padding: 10px 22px; border: none; }
        .btn-nueva-lista:hover { background-color: #59309e; transform: translateY(-2px); }

        .listas-grid { margin-top: 28px; display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 20px; }
        .lista-card { background: rgba(10,12,14,0.6); padding: 18px; border-radius: 12px; color: var(--light); box-shadow: 0 6px 20px rgba(0,0,0,0.5); }
        .lista-card h5 { margin-bottom: 8px; }
        .text-muted-custom { color: var(--muted); }

        /* modal animations */
        @@keyframes slideDown { from { transform: translateY(-20px); opacity: 0 } to { transform: translateY(0); opacity: 1 } }
        .modal-content { border-radius: 12px; animation: slideDown .28s ease; }
        .modal-header { background-color: #6f42c1; color: white; border-top-left-radius: 12px; border-top-right-radius: 12px; }
        .modal-backdrop.show { backdrop-filter: blur(4px); background-color: rgba(0,0,0,0.45); }
        footer { margin-top: auto; padding: 12px 0; text-align:center; color: var(--muted); }
    </style>
</head>
<body>

    <!-- NAVBAR (igual que en tus otras vistas client) -->
    <header class="header">
        <div class="logo"><i class="fa-solid fa-film"></i>WatchLenn</div>
        <nav class="nav-links">
            <a href="/Cliente/Index">Inicio</a>
            <a href="/Cliente/Pelis">Películas</a>
            <a href="/Cliente/Series">Series</a>
            <a href="#">Popular</a>
            <a href="/Cliente/ListasCliente" class="nav-active">Mis Listas</a>
        </nav>

        <div class="nav-actions">
            <a href="/Cliente/Gemini" class="btn-login">Crea tu historia</a>
            <div class="user-info">
                <partial name="_LoginPartial" />
            </div>
            <div class="avatar"><i class="fa-solid fa-user"></i></div>
        </div>
    </header>

    <main>
        <section class="listas-container container">
            <div class="d-flex justify-content-between align-items-center">
                <h2 class="fw-bold mb-0">Mis Listas</h2>
                <button id="btnNuevaLista" class="btn-nueva-lista">
                    <i class="fa-solid fa-plus me-2"></i> Nueva Lista
                </button>
            </div>

            <div class="listas-grid">
                @if (Model != null && Model.Any())
                {
                    foreach (var lista in Model)
                    {
                        <div class="lista-card">
                            <h5>@lista.NombreLista</h5>
                            @* Si añadiste FechaCreacion mostrarla, si no, comentar *@
                            @if (lista.GetType().GetProperty("FechaCreacion") != null)
                            {
                                <p class="text-muted-custom mb-2">Creada: @((DateTime)lista.GetType().GetProperty("FechaCreacion").GetValue(lista)!).ToString("dd/MM/yyyy")</p>
                            }
                            <div class="d-flex gap-2">
                                <a asp-controller="Cliente" asp-action="VerLista" asp-route-id="@lista.Id" class="btn btn-outline-light btn-sm">Ver</a>
                                <form asp-controller="Cliente" asp-action="EliminarLista" asp-route-id="@lista.Id" method="post" onsubmit="return confirm('¿Eliminar lista?');">
                                    <button type="submit" class="btn btn-danger btn-sm">Eliminar</button>
                                </form>
                            </div>
                        </div>
                    }
                }
                else
                {
                    <div class="col-12 text-center">
                        <p class="text-muted-custom">Aún no tienes listas creadas. Empieza a agregar películas a tus listas favoritas.</p>
                        <a href="#" id="btnNuevaListaAlt" class="btn-nueva-lista mt-2"><i class="fa-solid fa-plus me-2"></i> Agregar</a>
                    </div>
                }
            </div>
        </section>
    </main>

    <!-- MODAL CREAR NUEVA LISTA (demo, cierra correctamente) -->
    <div class="modal fade" id="modalNuevaLista" tabindex="-1" aria-labelledby="modalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content shadow-lg border-0">
                <div class="modal-header">
                    <h5 class="modal-title fw-bold" id="modalLabel">Crear Nueva Lista</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body p-4">
                    <form id="formNuevaLista">
                        <div class="mb-3">
                            <label for="nombreLista" class="form-label fw-semibold">Nombre de la lista</label>
                            <input type="text" class="form-control" id="nombreLista" placeholder="Ej. Favoritos, Pendientes..." required>
                        </div>
                        <div class="d-flex justify-content-end mt-3">
                            <button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal">Cerrar</button>
                            <button type="submit" class="btn btn-primary">Crear</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <footer class="border-top footer">
        <div class="container">&copy; 2025 - PROYECTOMOVIE</div>
    </footer>

    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // Obtener instancias de botones (puede haber dos botones que abren modal)
        const abrirBtns = [document.getElementById('btnNuevaLista'), document.getElementById('btnNuevaListaAlt')].filter(Boolean);
        const modalEl = document.getElementById('modalNuevaLista');
        const modalInstance = modalEl ? new bootstrap.Modal(modalEl) : null;

        abrirBtns.forEach(b => b.addEventListener('click', (e) => {
            e.preventDefault();
            modalInstance?.show();
        }));

        // submit demo
        document.getElementById('formNuevaLista').addEventListener('submit', function (e) {
            e.preventDefault();
            const nombre = document.getElementById('nombreLista').value.trim();
            if (!nombre) return alert('Escribe un nombre para la lista.');
            // demo: solo cerramos y reseteamos
            alert(`Lista "${nombre}" (demo) creada.`);
            modalInstance?.hide();
            this.reset();
            // aquí podrías hacer fetch/POST al controlador para crear en BD
        });
    </script>
</body>
</html>


